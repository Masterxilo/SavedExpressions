Cell[BoxData[RowBox[{"Persist", "[", 
    RowBox[{"\"TestingNotebookHeldVerificationTests\"", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RedefinePublicFunction", "[", "\[IndentingNewLine]", 
        RowBox[{RowBox[{"TestingNotebookHeldVerificationTests", "[", "]"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", "\"make a list \
of Hold VerificationTest items from the current testing notebook\"", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"SequenceCases", "[", RowBox[{RowBox[{"NotebookRead", "@", 
                RowBox[{"Cells", "[", "]"}]}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                  "\[IndentingNewLine]", RowBox[{RowBox[{"i", ":", RowBox[
                       {"Cell", "[", RowBox[{"___", ",", 
                          "\"VerificationTest\"", ",", "___"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", RowBox[{"o", ":", RowBox[{"Cell", 
                        "[", RowBox[{"___", ",", "\"ExpectedOutput\"", ",", 
                          "___"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{RowBox[{"(", RowBox[{"m", ":", RowBox[{"Cell", 
                          "[", RowBox[{"___", ",", "\"ExpectedMessage\"", 
                          ",", "___"}], "]"}]}], ")"}], "~", "Optional", "~", 
                      "EmptyListInputCell"}], ",", "\[IndentingNewLine]", 
                    RowBox[{RowBox[{"(", RowBox[{"p", ":", RowBox[{"Cell", 
                          "[", RowBox[{"___", ",", "\"TestOptions\"", ",", 
                          "___"}], "]"}]}], ")"}], "~", "Optional", "~", 
                      "EmptyListInputCell"}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "}"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[
                       {RowBox[{"input", "=", RowBox[{RowBox[{"ToExpression", 
                          "[", RowBox[{RowBox[{"First", "@", "i"}], ",", 
                          "StandardForm", ",", "HoldComplete"}], "]"}], "//", 
                          "FlattenNull"}]}], ",", "\[IndentingNewLine]", 
                        RowBox[{"output", "=", RowBox[{RowBox[
                          {"ToExpression", "[", RowBox[{RowBox[{"First", "@", 
                          "o"}], ",", "StandardForm", ",", "HoldComplete"}], 
                          "]"}], "//", "FlattenNull"}]}], ",", 
                        "\[IndentingNewLine]", RowBox[{"messages", "=", 
                          RowBox[{RowBox[{"ToExpression", "[", RowBox[
                          {RowBox[{"First", "@", "m"}], ",", "StandardForm", 
                          ",", "HoldComplete"}], "]"}], "//", 
                          "FlattenNull"}]}], ",", "\[IndentingNewLine]", 
                        RowBox[{"options", "=", RowBox[{RowBox[
                          {"ToExpression", "[", RowBox[{RowBox[{"First", "@", 
                          "p"}], ",", "StandardForm", ",", "HoldComplete"}], 
                          "]"}], "//", "FlattenNull"}]}]}], 
                      "\[IndentingNewLine]", "}"}], "~", "With", "~", 
                    RowBox[{"(", RowBox[{RowBox[{"Hold", "@", RowBox[
                          {"VerificationTest", "[", RowBox[{"input", ",", 
                          "output", ",", "messages", ",", "options"}], 
                          "]"}]}], "/.", RowBox[{"{", RowBox[{RowBox[
                          {RowBox[{RowBox[{"Verbatim", "[", "HoldComplete", 
                          "]"}], "@", "x_"}], "\[RuleDelayed]", "x"}], ",", 
                          RowBox[{RowBox[{RowBox[{"Verbatim", "[", 
                          "HoldComplete", "]"}], "@", "x__"}], 
                          "\[RuleDelayed]", RowBox[{"CompoundExpression", 
                          "@", "x"}]}]}], "}"}]}], ")"}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]], "Input", 
 CellChangeTimes -> {{3.680612941136346*^9, 3.680612971080679*^9}, 
   {3.680613171770117*^9, 3.6806132254921265*^9}, 
   {3.6806132927230673*^9, 3.680613314204834*^9}}, 
 CellTags -> "depersistedCell9a8b53c2-8cb3-4d40-8672-fed04424b912"]
