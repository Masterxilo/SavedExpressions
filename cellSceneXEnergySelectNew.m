System`Cell[System`BoxData[System`RowBox[System`List["PRedefinePublicFunction", "[", "\[IndentingNewLine]", System`RowBox[System`List[System`RowBox[System`List["SceneXEnergySelectNew", "[", System`RowBox[System`List[System`RowBox[System`List["dimension", ":", System`RowBox[System`List["2", "|", "3"]]]], ",", "lightIntensityParameterCount_Integer", ",", "colorDim_Integer"]], "]"]], "\[IndentingNewLine]", ",", "\"constructs the SOP selection function, which maps variables as used in the SceneXEnergyf[] expression to variable names as given in SceneXDEnergyDataAsFM\"", "\[IndentingNewLine]", ",", System`RowBox[System`List["Module", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List["select", ",", "position"]], "}"]], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", System`RowBox[System`List[System`RowBox[System`List["position", "=", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List["x", ",", "y", ",", "z"]], "}"]], "[", System`RowBox[System`List["[", System`RowBox[System`List[";;", "dimension"]], "]"]], "]"]]]], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", System`RowBox[System`List["With", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List["selection", "=", System`RowBox[System`List["Join", "[", System`RowBox[System`List[System`RowBox[System`List["{", "}"]], "\[IndentingNewLine]", "\[IndentingNewLine]", System`RowBox[System`List["(*", System`RowBox[System`List["globals", ":", " ", "unchanged"]], "*)"]], "\[IndentingNewLine]", ",", System`RowBox[System`List["IdentityRule", "/@", System`RowBox[System`List["Array", "[", System`RowBox[System`List["l", ",", "lightIntensityParameterCount"]], "]"]]]], "\[IndentingNewLine]", ",", System`RowBox[System`List["IdentityRule", "/@", System`RowBox[System`List["SceneXEnergyWeightNames", "[", "]"]]]], "\[IndentingNewLine]", "\[IndentingNewLine]", System`RowBox[System`List["(*", System`RowBox[System`List[System`RowBox[System`List["locals", " ", "a"]], ",", "doriginal", ",", "d"]], "*)"]], "\[IndentingNewLine]", ",", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["a", "@", "#"]], "\[Rule]", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["Sequence", "@@", System`RowBox[System`List["(", System`RowBox[System`List["position", "+", "#"]], ")"]]]], ",", "1"]], "}"]]]], "&"]], "/@", System`RowBox[System`List["FlatCoordinateBoundsArray", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["-", "1"]], ",", "1"]], "}"]], "~", "Table", "~", "dimension"]], "]"]]]], "\[IndentingNewLine]", ",", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["d", "@", "#"]], "\[Rule]", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["Sequence", "@@", System`RowBox[System`List["(", System`RowBox[System`List["position", "+", "#"]], ")"]]]], ",", "2"]], "}"]]]], "&"]], "/@", System`RowBox[System`List["FlatCoordinateBoundsArray", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["-", "1"]], ",", "1"]], "}"]], "~", "Table", "~", "dimension"]], "]"]]]], "\[IndentingNewLine]", ",", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["doriginal", "@", "#"]], "\[Rule]", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["Sequence", "@@", System`RowBox[System`List["(", System`RowBox[System`List["position", "+", "#"]], ")"]]]], ",", "3"]], "}"]]]], "&"]], "/@", System`RowBox[System`List["FlatCoordinateBoundsArray", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["-", "1"]], ",", "1"]], "}"]], "~", "Table", "~", "dimension"]], "]"]]]], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", System`RowBox[System`List["(*", System`RowBox[System`List[System`RowBox[System`List["local", " ", "c"]], ",", " ", System`RowBox[System`List["in", " ", "all", " ", "colorDims"]]]], "*)"]], "\[IndentingNewLine]", System`RowBox[System`List["Flatten", "@", System`RowBox[System`List["Table", "[", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["c", "[", System`RowBox[System`List["#", ",", "cc"]], "]"]], "\[Rule]", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["Sequence", "@@", System`RowBox[System`List["(", System`RowBox[System`List["position", "+", "#"]], ")"]]]], ",", System`RowBox[System`List["3", "+", "cc"]]]], "}"]]]], "&"]], "/@", System`RowBox[System`List["FlatCoordinateBoundsArray", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["-", "1"]], ",", "1"]], "}"]], "~", "Table", "~", "dimension"]], "]"]]]], ",", System`RowBox[System`List["{", System`RowBox[System`List["cc", ",", "colorDim"]], "}"]]]], "]"]]]]]], "\[IndentingNewLine]", "]"]]]], "}"]], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["Hold", "[", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["select", "[", "in$", "]"]], ":=", "out$"]], ";"]], "]"]], "/.", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["in$", "\[Rule]", System`RowBox[System`List["(", System`RowBox[System`List[System`RowBox[System`List[System`RowBox[System`List["Pattern", "[", System`RowBox[System`List["#", ",", "_"]], "]"]], "&"]], "/@", "position"]], ")"]]]], ",", System`RowBox[System`List["out$", "\[Rule]", "selection"]]]], "}"]]]], "//", "ReleaseHold"]]]], "\[IndentingNewLine]", "]"]], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "select"]]]], "\[IndentingNewLine]", "]"]]]], "\[IndentingNewLine]", "]"]]], "Input", System`Rule[System`CellChangeTimes, System`List[System`List[3.6802710012501726`*^9, 3.6802710112536197`*^9], System`List[3.6802713573935213`*^9, 3.680271358291642`*^9], System`List[3.680272764086754`*^9, 3.6802727737968693`*^9], System`List[3.6802744761541185`*^9, 3.680274518196557`*^9], System`List[3.680274602962325`*^9, 3.680274641649598`*^9], System`List[3.680382153228388`*^9, 3.680382175052636`*^9], 3.680384117704606`*^9, 3.6809329694533405`*^9, System`List[3.680983824900607`*^9, 3.68098384321646`*^9], System`List[3.6809838745565653`*^9, 3.680983898089932`*^9], System`List[3.680983934940897`*^9, 3.680983989270704`*^9], System`List[3.6809840278568344`*^9, 3.680984121767028`*^9], System`List[3.6810374910137854`*^9, 3.681037522928727`*^9], 3.681716839965603`*^9, System`List[3.6817169813204327`*^9, 3.6817169859925003`*^9], System`List[3.683299552637599`*^9, 3.6832996860277486`*^9], System`List[3.683299904012989`*^9, 3.68329993722193`*^9], System`List[3.6833000135267763`*^9, 3.6833000234339485`*^9], 3.6834579452515097`*^9, System`List[3.6834580176849504`*^9, 3.683458100537961`*^9], System`List[3.6834581319209995`*^9, 3.6834581479154615`*^9], System`List[3.6834581788975477`*^9, 3.683458179585123`*^9], System`List[3.6834582335949326`*^9, 3.6834582886545362`*^9], System`List[3.683458343115426`*^9, 3.683458383271584`*^9], System`List[3.6834685708160725`*^9, 3.6834685794161587`*^9]]], System`Rule[System`CellTags, "depersistedCell34dc715f-cf87-4a16-9f37-c279023f0824"], System`Rule[System`CellID, 340360542]]