System`Cell[System`BoxData[System`RowBox[System`List["PRedefinePublicFunctionAlternatives", "[", "\n", System`RowBox[System`List["\"f(x) with undefined behaviour for out-of-range x\n\nTODO (disableable) error/range checking\n\nOptions (only in operator form):\nMethod -> None | Compile, compile tries to generate a function that can be evaluated very quickly\"", "\n", "\n", System`RowBox[System`List["(*", System`RowBox[System`List["TODO", " ", "shadows", " ", "some", " ", "rare", " ", "cases"]], "*)"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f_FiniteMapping", ",", System`RowBox[System`List["OptionsPattern", "[", "]"]]]], "]"]], ",", System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f", ",", System`RowBox[System`List["OptionValue", "@", "Method"]]]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f_FiniteMapping", ",", "None"]], "]"]], ",", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f", ",", "#"]], "]"]], "&"]]]], "}"]], "\n", "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Function", ",", "f_", ",", "___"]], "]"]], ",", System`RowBox[System`List["None", "|", "Compile"]]]], "]"]], ",", "f"]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Rules", ",", "assoc_Association"]], "]"]], ",", System`RowBox[System`List["None", "|", "Compile"]]]], "]"]], ",", System`RowBox[System`List[System`RowBox[System`List["Lookup", "[", System`RowBox[System`List["assoc", ",", System`RowBox[System`List["Key", "[", "#", "]"]]]], "]"]], "&"]]]], "}"]], "\n", "\n", ",", System`RowBox[System`List["{", "\n", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Array", ",", " ", "level_", ",", " ", "array_"]], "]"]], ",", "Compile"]], "]"]], ",", " ", "\n", System`RowBox[System`List["(*", System`RowBox[System`List["TODO", " ", "does", " ", "not", " ", "work", " ", "with", " ", "Arrays", " ", "of", " ", "anything", " ", "but", " ", System`RowBox[System`List["_Real", "!"]]]], "*)"]], "\n", System`RowBox[System`List["Module", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List["$array", "=", "array"]], "}"]], ",", " ", System`RowBox[System`List["Compile", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List["{", System`RowBox[System`List["i", ",", "_Integer", ",", "1"]], "}"]], "}"]], ",", System`RowBox[System`List["Extract", "[", System`RowBox[System`List["$array", ",", "i"]], "]"]], ",", System`RowBox[System`List["{", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["Extract", "[", "__", "]"]], ",", "_Real"]], "}"]], "}"]]]], "]"]]]], "]"]]]], " ", System`RowBox[System`List["(*", System`RowBox[System`List[System`RowBox[System`List["note", ":", " ", System`RowBox[System`List["this", " ", "references", " ", "the", " ", "array"]]]], ",", " ", System`RowBox[System`List[System`RowBox[System`List["instead", " ", "of", " ", "copying", " ", System`RowBox[System`List["it", ".", " ", "could"]], " ", "also", " ", "modify", " ", "it", " ", "in"]], "-", System`RowBox[System`List["place", "!"]]]]]], "*)"]], "\n", "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Range", ",", " ", "imin_Integer", ",", " ", "imax_Integer", ",", " ", "di_Integer"]], "]"]], ",", "Compile"]], "]"]], ",", " ", System`RowBox[System`List["Compile", "[", System`RowBox[System`List[System`RowBox[System`List["List", "@", System`RowBox[System`List["{", System`RowBox[System`List["x", ",", "_Integer"]], "}"]]]], ",", System`RowBox[System`List["imin", "+", System`RowBox[System`List[System`RowBox[System`List["(", System`RowBox[System`List["x", "-", "1"]], ")"]], "*", "di"]]]]]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["FlatCoordinateBoundsArray", ",", " ", "coordinateBounds_"]], "]"]], ",", "Compile"]], "]"]], ",", " ", System`RowBox[System`List["FlatIndexToPosition", "[", "coordinateBounds", "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", "\n", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Concat", ",", " ", "f_FiniteMapping", ",", " ", "g_FiniteMapping"]], "]"]], ",", "Compile"]], "]"]], ",", " ", "\n", System`RowBox[System`List["With", "[", System`RowBox[System`List[System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["domainFMemberQ", "=", System`RowBox[System`List["FMDomainMemberQ", "[", "f", "]"]]]], ",", System`RowBox[System`List["fc", "=", System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f", ",", System`RowBox[System`List["Method", "\[Rule]", "Compile"]]]], "]"]]]], ",", System`RowBox[System`List["gc", "=", System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["g", ",", System`RowBox[System`List["Method", "\[Rule]", "Compile"]]]], "]"]]]]]], "}"]], ",", System`RowBox[System`List[System`RowBox[System`List["If", "[", System`RowBox[System`List[System`RowBox[System`List["domainFMemberQ", "@", "#"]], ",", System`RowBox[System`List["fc", "@", "#"]], ",", System`RowBox[System`List["gc", "@", "#"]]]], "]"]], "&"]]]], "]"]]]], "\n", "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["InverseFunction", ",", "f_FiniteMapping", ",", "___"]], "]"]], ",", "Compile"]], "]"]], ",", " ", System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f", ",", System`RowBox[System`List["Method", "\[Rule]", "Compile"]]]], "]"]]]], "}"]], "\n", "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f_FiniteMapping", ",", "Compile"]], "]"]], ",", System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List["f", ",", "None"]], "]"]]]], "}"]], "\n", "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["f", ":", System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Rules", ",", "assoc_Association"]], "]"]]]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["Lookup", "[", System`RowBox[System`List["assoc", ",", System`RowBox[System`List["Key", "[", "x", "]"]]]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["f", ":", System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Lists", ",", "a_", ",", "fa_", ",", "vpf_"]], "]"]]]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["Extract", "[", System`RowBox[System`List["fa", ",", System`RowBox[System`List["vpf", "[", "x", "]"]]]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["f", ":", System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Expression", ",", "levelspec_", ",", "e_"]], "]"]]]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["Extract", "[", System`RowBox[System`List["e", ",", "x"]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["f", ":", System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Array", ",", "level_", ",", "array_"]], "]"]]]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["Extract", "[", System`RowBox[System`List["array", ",", "x"]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Range", ",", " ", "imin_Integer", ",", " ", "imax_Integer", ",", " ", "di_Integer"]], "]"]], ",", "x_"]], System`RowBox[System`List["(*", System`RowBox[System`List["Integer", "?", "Positive"]], "*)"]], "]"]], ",", " ", System`RowBox[System`List["imin", "+", System`RowBox[System`List[System`RowBox[System`List["(", System`RowBox[System`List["x", "-", "1"]], ")"]], "*", "di"]]]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Function", ",", "f_", ",", "___"]], "]"]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["f", "@", "x"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Composition", ",", "f_FiniteMapping", ",", " ", "g_FiniteMapping"]], "]"]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["f", "@", System`RowBox[System`List["g", "@", "x"]]]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["FlatCoordinateBoundsArray", ",", " ", "coordinateBounds_"]], "]"]], ",", "x_"]], "]"]], ",", " ", System`RowBox[System`List["FlatIndexToPosition", "[", System`RowBox[System`List["x", ",", "coordinateBounds"]], "]"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["InverseFunction", ",", "f_FiniteMapping", ",", "___"]], "]"]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["f", "~", "FMEvaluate", "~", "x"]]]], "}"]], "\n", ",", System`RowBox[System`List["{", System`RowBox[System`List[System`RowBox[System`List["FMEvaluate", "[", System`RowBox[System`List[System`RowBox[System`List["FiniteMapping", "[", System`RowBox[System`List["Concat", ",", " ", "f_FiniteMapping", ",", " ", "g_FiniteMapping"]], "]"]], ",", "x_"]], "]"]], ",", System`RowBox[System`List["If", "[", System`RowBox[System`List[System`RowBox[System`List["FMDomainMemberQ", "[", System`RowBox[System`List["f", ",", "x"]], "]"]], ",", System`RowBox[System`List["f", "~", "FMEvaluate", "~", "x"]], ",", System`RowBox[System`List["g", "~", "FMEvaluate", "~", "x"]]]], "]"]]]], "}"]], "\n", "\n", ",", System`RowBox[System`List["Options", "\[Rule]", System`RowBox[System`List["{", System`RowBox[System`List["Method", "\[Rule]", "None"]], "}"]]]]]], "\n", "]"]]], "Code", System`Rule[System`CellChangeTimes, System`List[System`List[3.6815674723302517`*^9, 3.68156758311055`*^9], System`List[3.681567682990239`*^9, 3.6815677013030987`*^9], System`List[3.6815677352214437`*^9, 3.681567891021942`*^9], System`List[3.681567959368266`*^9, 3.681568076260194`*^9], System`List[3.6815684462000237`*^9, 3.6815684895511427`*^9], System`List[3.6815688701632957`*^9, 3.681568879700202`*^9], 3.681574752433674`*^9, 3.6816479349282827`*^9, System`List[3.6832835082180476`*^9, 3.6832835434078207`*^9], System`List[3.683284560887412`*^9, 3.6832846365326385`*^9], System`List[3.683290836152561`*^9, 3.6832908598955455`*^9], System`List[3.683297024937515`*^9, 3.6832970344255733`*^9], System`List[3.6832974806170015`*^9, 3.6832974875592394`*^9], System`List[3.683298476357643`*^9, 3.6832985135906024`*^9], System`List[3.6833005945501814`*^9, 3.683300609749948`*^9], System`List[3.683447624957363`*^9, 3.6834476497733665`*^9], System`List[3.683449550160744`*^9, 3.683449554310028`*^9], 3.683456466887678`*^9, System`List[3.6834565146519837`*^9, 3.683456526320569`*^9], 3.6834590276208096`*^9, System`List[3.6834591648480115`*^9, 3.6834591867482557`*^9], System`List[3.683461025836393`*^9, 3.6834611798461328`*^9], System`List[3.6834612368360033`*^9, 3.6834612373726597`*^9], System`List[3.683461293046894`*^9, 3.683461358771593`*^9], System`List[3.683461447558836`*^9, 3.6834614738716617`*^9], System`List[3.6834626363196607`*^9, 3.683462771578965`*^9], System`List[3.6834631062734346`*^9, 3.683463123581318`*^9], System`List[3.6834631563254123`*^9, 3.6834631949047723`*^9], System`List[3.6834633247494316`*^9, 3.6834633768439074`*^9], System`List[3.6834636297841077`*^9, 3.6834636526934757`*^9], System`List[3.68346377233266`*^9, 3.683463794066553`*^9], 3.683466867230343`*^9, 3.683466907132107`*^9, System`List[3.683478592796253`*^9, 3.6834786877214518`*^9], System`List[3.683479218410558`*^9, 3.6834792652978`*^9], System`List[3.6834793144151354`*^9, 3.683479345910778`*^9]]], System`Rule[System`CellTags, "depersistedCell50c728a1-b2db-4de6-b730-b2f5b403c4e5"]]